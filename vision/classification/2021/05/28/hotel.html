<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Identifying Hotels | AI curious</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Identifying Hotels" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Some notes from a kaggle competition" />
<meta property="og:description" content="Some notes from a kaggle competition" />
<link rel="canonical" href="https://joatom.github.io/ai_curious/vision/classification/2021/05/28/hotel.html" />
<meta property="og:url" content="https://joatom.github.io/ai_curious/vision/classification/2021/05/28/hotel.html" />
<meta property="og:site_name" content="AI curious" />
<meta property="og:image" content="https://joatom.github.io/ai_curious/images/logo_hotel.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-28T00:00:00-05:00" />
<script type="application/ld+json">
{"dateModified":"2021-05-28T00:00:00-05:00","datePublished":"2021-05-28T00:00:00-05:00","url":"https://joatom.github.io/ai_curious/vision/classification/2021/05/28/hotel.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://joatom.github.io/ai_curious/vision/classification/2021/05/28/hotel.html"},"headline":"Identifying Hotels","image":"https://joatom.github.io/ai_curious/images/logo_hotel.png","description":"Some notes from a kaggle competition","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/ai_curious/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://joatom.github.io/ai_curious/feed.xml" title="AI curious" /><link rel="shortcut icon" type="image/x-icon" href="/ai_curious/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/ai_curious/">AI curious</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ai_curious/about/">About Me</a><a class="page-link" href="/ai_curious/search/">Search</a><a class="page-link" href="/ai_curious/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Identifying Hotels</h1><p class="page-description">Some notes from a kaggle competition</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-05-28T00:00:00-05:00" itemprop="datePublished">
        May 28, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/ai_curious/categories/#Vision">Vision</a>
        &nbsp;
      
        <a class="category-tags-link" href="/ai_curious/categories/#Classification">Classification</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <blockquote>
  <p>“Recognizing a hotel from an image of a hotel room is important for human trafficking investigations. Images directly
link victims to places and can help verify where victims have
been trafficked.” (Stylianou et al., 2019).</p>
</blockquote>

<p>As part of the <a href="https://sites.google.com/view/fgvc8/home">Eight Workshop on Fine-Grained Visual Categorization</a> a kaggle competition was launched to support investigations by advancing models to identify hotels from images.</p>

<p>This post contains some parts of my contribution to the <a href="https://www.kaggle.com/c/hotel-id-2021-fgvc8/overview">Hotel-ID to Combat Human Trafficking 2021 - FGVC8</a> kaggle competition.</p>

<h1 id="the-challenge">The challenge</h1>
<p>The competition contained 97000+ images of hotel rooms from 7700<strong>!</strong> different hotels around the world. The objective was to identify the hotels of 13000 images from the hidden test set. The metric of the competition was Mean Average Precision of the top 5 picks (MAP@5). My solution scored <strong>14th place</strong> out of 92 teams with a 0.6164 MAP@5 on the private leaderboard.</p>

<p>My solution contained six CNN models with various configurations. More technical details and why I ended up with rather simple models is described in a kaggle <a href="https://www.kaggle.com/c/hotel-id-2021-fgvc8/discussion/242030">discussion topic</a>.</p>

<p>Here I post the training and inference of one of the six models as well as the ensemble inference code.</p>

<h1 id="training">Training</h1>
<p>The final training was done on the entire train dataset. I didn’t choose a cross validation strategy to safe training time. To keep variance low nonetheless I relied on the usual regularization strategies, such as dropout and augmentation and in particular on test time augmentation during inference.</p>

<p>To refine the model a validation set can be created by setting the <code class="language-plaintext highlighter-rouge">debug</code> flag as described in the notebook.</p>
<iframe src="https://www.kaggle.com/embed/joatom/hotel-train-fastai-densnet161?kernelSessionId=63702072" height="800" style="margin: 0 auto; width: 100%; max-width: 950px;" frameborder="0" scrolling="auto" title="Hotel train (fastai + densnet161)"></iframe>

<h1 id="inference">Inference</h1>
<iframe src="https://www.kaggle.com/embed/joatom/hotel-inference-fastai?kernelSessionId=63761117" height="800" style="margin: 0 auto; width: 100%; max-width: 950px;" frameborder="0" scrolling="auto" title="Hotel inference (fastai)"></iframe>

<h1 id="inference-ensemble">Inference ensemble</h1>
<iframe src="https://www.kaggle.com/embed/joatom/fgvc8-hotel-ensemble-inference?kernelSessionId=63977973" height="800" style="margin: 0 auto; width: 100%; max-width: 950px;" frameborder="0" scrolling="auto" title="fgvc8 - hotel ensemble (inference)"></iframe>

<h1 id="references">References</h1>

<p>Stylianou, Abby and Xuan, Hong and Shende, Maya and Brandt, Jonathan and Souvenir, Richard and Pless, Robert (2019). Hotels-50K: A Global Hotel Recognition Dataset. <em>The AAAI Conference on Artificial Intelligence (AAAI)</em></p>

  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="joatom/ai_curious"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/ai_curious/vision/classification/2021/05/28/hotel.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/ai_curious/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/ai_curious/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/ai_curious/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Personal blog</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/joatom" title="joatom"><svg class="svg-icon grey"><use xlink:href="/ai_curious/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/johannestomason" title="johannestomason"><svg class="svg-icon grey"><use xlink:href="/ai_curious/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
