<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Notes about Sequence Modelling | AI curious</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Notes about Sequence Modelling" />
<meta name="author" content="Johannes Tomasoni" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Predicting Ventilator Pressure Time Series" />
<meta property="og:description" content="Predicting Ventilator Pressure Time Series" />
<link rel="canonical" href="https://joatom.github.io/ai_curious/timeseries/transformer/lstm/2021/11/22/vpp-seq.html" />
<meta property="og:url" content="https://joatom.github.io/ai_curious/timeseries/transformer/lstm/2021/11/22/vpp-seq.html" />
<meta property="og:site_name" content="AI curious" />
<meta property="og:image" content="https://joatom.github.io/ai_curious/images/logo_vpp_seq.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-22T00:00:00-06:00" />
<script type="application/ld+json">
{"dateModified":"2021-11-22T00:00:00-06:00","datePublished":"2021-11-22T00:00:00-06:00","url":"https://joatom.github.io/ai_curious/timeseries/transformer/lstm/2021/11/22/vpp-seq.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://joatom.github.io/ai_curious/timeseries/transformer/lstm/2021/11/22/vpp-seq.html"},"headline":"Notes about Sequence Modelling","image":"https://joatom.github.io/ai_curious/images/logo_vpp_seq.png","author":{"@type":"Person","name":"Johannes Tomasoni"},"description":"Predicting Ventilator Pressure Time Series","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/ai_curious/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://joatom.github.io/ai_curious/feed.xml" title="AI curious" /><link rel="shortcut icon" type="image/x-icon" href="/ai_curious/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/ai_curious/">AI curious</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ai_curious/about/">About Me</a><a class="page-link" href="/ai_curious/search/">Search</a><a class="page-link" href="/ai_curious/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Notes about Sequence Modelling</h1><p class="page-description">Predicting Ventilator Pressure Time Series</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-11-22T00:00:00-06:00" itemprop="datePublished">
        Nov 22, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Johannes Tomasoni</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/ai_curious/categories/#TimeSeries">TimeSeries</a>
        &nbsp;
      
        <a class="category-tags-link" href="/ai_curious/categories/#Transformer">Transformer</a>
        &nbsp;
      
        <a class="category-tags-link" href="/ai_curious/categories/#LSTM">LSTM</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Notes-about-Sequence-Modelling">Notes about Sequence Modelling </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Feature-engineering">Feature engineering </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Scaler">Scaler </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Folds">Folds </a></li>
<li class="toc-entry toc-h2"><a href="#Dataloader">Dataloader </a></li>
<li class="toc-entry toc-h2"><a href="#Model">Model </a></li>
<li class="toc-entry toc-h2"><a href="#Metric-and-Loss-Function">Metric and Loss Function </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Masked-MAE-metric">Masked MAE metric </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Combined-Loss-function">Combined Loss function </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Training">Training </a></li>
<li class="toc-entry toc-h1"><a href="#References">References </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-11-22-vpp-seq.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Notes-about-Sequence-Modelling">
<a class="anchor" href="#Notes-about-Sequence-Modelling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Notes about Sequence Modelling<a class="anchor-link" href="#Notes-about-Sequence-Modelling"> </a>
</h1>
<p>I lately participated in the <a href="https://www.kaggle.com/c/ventilator-pressure-prediction">Google Brain - Ventilator Pressure Prediction</a> competition. I didn't score decent, but I still learned a lot. And some of it is worth to sum up, so I can easily look it up later.</p>
<p>The goal of the competition was to predict airway pressure of lungs that are ventilated in a clinician-intensive procedure. Given values of the input pressure (<code>u_in</code>) we had to predict the output <code>pressure</code> for a time frame of a few seconds.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:xlabel='time_step', ylabel='Pressure'&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since all <code>u_in</code> values for a time frame were given we can build a bidirectional sequence model. Unless in a typical time-series problem where the future points are unknown at a certain time step, we know the future and past input values. Therefore I decided not to <em>mask</em> the sequences while training.</p>
<p>A good model choice for sequencing tasks are LSTMs and Transformers. I built a model that combines both architectures. I also tried XGBoost with a lot of features (especially windowing, rolling, lead, lag features) engineering, But neural nets (NN) performed better, here. Though I kept some of the engineered features as embeddings for the NN model.</p>
<p>The competition metric was mean average error (MAE). Only those pressures were evaluated, that appear while filling the lungs with oxygen.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Feature-engineering">
<a class="anchor" href="#Feature-engineering" aria-hidden="true"><span class="octicon octicon-link"></span></a>Feature engineering<a class="anchor-link" href="#Feature-engineering"> </a>
</h2>
<p>Besides the given features, <em>u_in</em>, <em>u_out</em>, <em>R</em>, <em>C</em> and <em>time_step</em> I defined several features. They can by categorized as:</p>
<ul>
<li>area (accumulation of u_in over time) from <a href="https://www.kaggle.com/cdeotte/ensemble-folds-with-median-0-153">this notebook</a>
</li>
<li>one hot encoding of ventilator parameters R and C</li>
<li>statistical (mean, max, skewness, quartiles, rolling mean, ...)</li>
<li>shifted input pressure</li>
<li>input pressure performance over window</li>
<li>inverse features</li>
</ul>
<p>To reduce memory consumption I used a function from <a href="https://www.kaggle.com/konradb/tabnet-end-to-end-starter">this notebook</a>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">gen_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    
    <span class="c1"># area feature from https://www.kaggle.com/cdeotte/ensemble-folds-with-median-0-153</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'area'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'time_step'</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">'u_in'</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'area_crv'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.5</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s1">'time_step'</span><span class="p">])</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">'u_in'</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'area'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'breath_id'</span><span class="p">)[</span><span class="s1">'area'</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'area_crv'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'breath_id'</span><span class="p">)[</span><span class="s1">'area_crv'</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'area_inv'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'breath_id'</span><span class="p">)[</span><span class="s1">'area'</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">'max'</span><span class="p">)</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">'area'</span><span class="p">]</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">'ts'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'breath_id'</span><span class="p">)[</span><span class="s1">'id'</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'int'</span><span class="p">)</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">'R4'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">'R'</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'R'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'R'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'str'</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'C'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'C'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'str'</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">in_out</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span> <span class="c1">#,1</span>
        <span class="k">for</span> <span class="n">qs</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="sa">f</span><span class="s1">'u_in_</span><span class="si">{</span><span class="n">in_out</span><span class="si">}</span><span class="s1">_q</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">qs</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">u_out</span><span class="o">==</span><span class="n">in_out</span><span class="p">,</span> <span class="sa">f</span><span class="s1">'u_in_</span><span class="si">{</span><span class="n">in_out</span><span class="si">}</span><span class="s1">_q</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">qs</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">u_out</span><span class="o">==</span><span class="n">in_out</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'breath_id'</span><span class="p">)[</span><span class="s1">'u_in'</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">'quantile'</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">agg_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'count'</span><span class="p">,</span> <span class="s1">'std'</span><span class="p">,</span> <span class="s1">'skew'</span><span class="p">,</span><span class="s1">'mean'</span><span class="p">,</span> <span class="s1">'min'</span><span class="p">,</span> <span class="s1">'max'</span><span class="p">,</span> <span class="s1">'median'</span><span class="p">,</span> <span class="s1">'last'</span><span class="p">,</span> <span class="s1">'first'</span><span class="p">]:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sa">f</span><span class="s1">'u_out_</span><span class="si">{</span><span class="n">in_out</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">agg_type</span><span class="si">}</span><span class="s1">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">u_out</span><span class="o">==</span><span class="n">in_out</span><span class="p">,</span> <span class="sa">f</span><span class="s1">'u_out_</span><span class="si">{</span><span class="n">in_out</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">agg_type</span><span class="si">}</span><span class="s1">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">u_out</span><span class="o">==</span><span class="n">in_out</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'breath_id'</span><span class="p">)[</span><span class="s1">'u_in'</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">agg_type</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sa">f</span><span class="s1">'u_in'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">u_in</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">'u_out_</span><span class="si">{</span><span class="n">in_out</span><span class="si">}</span><span class="s1">_mean'</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">'u_out_</span><span class="si">{</span><span class="n">in_out</span><span class="si">}</span><span class="s1">_std'</span><span class="p">]</span><span class="o">+</span><span class="mf">1e-6</span><span class="p">)</span>
    
    
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sa">f</span><span class="s1">'shift_u_in_</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s1">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sa">f</span><span class="s1">'shift_u_in_</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s1">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'breath_id'</span><span class="p">)[</span><span class="s1">'u_in'</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sa">f</span><span class="s1">'shift_u_in_m</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s1">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sa">f</span><span class="s1">'shift_u_in_m</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s1">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'breath_id'</span><span class="p">)[</span><span class="s1">'u_in'</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">)</span>
    
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf1'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">u_in</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shift_u_in_1</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf3'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">u_in</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shift_u_in_3</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf5'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">u_in</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shift_u_in_5</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf7'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">u_in</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shift_u_in_7</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">perf1</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf3'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">perf3</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf5'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">perf5</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf7'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">perf7</span><span class="o">-</span><span class="mi">1</span>
    
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf1inv'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">u_in</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shift_u_in_m1</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf3inv'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">u_in</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shift_u_in_m3</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf5inv'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">u_in</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shift_u_in_m5</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf7inv'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">u_in</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shift_u_in_m7</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf1inv'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">perf1inv</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf3inv'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">perf3inv</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf5inv'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">perf5inv</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'perf7inv'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">perf7inv</span><span class="o">-</span><span class="mi">1</span>
    
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'rol_mean5'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">u_in</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Scaler">
<a class="anchor" href="#Scaler" aria-hidden="true"><span class="octicon octicon-link"></span></a>Scaler<a class="anchor-link" href="#Scaler"> </a>
</h3>
<p>The data was transformed with <em>scikit's RobustScaler</em> to reduce influence of outliers.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">-</span><span class="nb">set</span><span class="p">([</span><span class="s1">'id'</span><span class="p">,</span><span class="s1">'breath_id'</span><span class="p">,</span><span class="s1">'pressure'</span><span class="p">,</span><span class="s1">'kfold_2021'</span><span class="p">,</span><span class="s1">'kfold'</span><span class="p">]))</span>
<span class="n">features</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="n">rs</span> <span class="o">=</span> <span class="n">RobustScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">features</span><span class="p">])</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Folds">
<a class="anchor" href="#Folds" aria-hidden="true"><span class="octicon octicon-link"></span></a>Folds<a class="anchor-link" href="#Folds"> </a>
</h2>
<p>I didn't do cross validation here, but instead trained the final model on the entire dataset. Nevertheless it's helpful to build kfolds for model evaluation. I build GroupKFold over <code>breath_id</code> to keep the entire time frame in the same fold.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dataloader">
<a class="anchor" href="#Dataloader" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dataloader<a class="anchor-link" href="#Dataloader"> </a>
</h2>
<p>Since the data is quite small (ca. 800 MB after memory reduction) I decided to load the entire train set in the <code>Dataset</code> object during construction (calling <code>__init__()</code>). In a first attempt I loaded the data as <em>Pandas Dataframe</em>. Then I figured out (from <a href="https://www.kaggle.com/junkoda/pytorch-lstm-with-tensorflow-like-initialization">this notebook</a>) that converting the Dataframe into an numpy array speeds up training significantly. The Dataframe is converted to an numpy array by the scaler.</p>
<p>Since the competition metric only evaluates the pressures where <code>u_out==0</code> I also provide a mask tensor, which can later on be used feeding the loss and metric functions.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">VPPDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">is_train</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kfolds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'R'</span><span class="p">,</span><span class="s1">'C'</span><span class="p">,</span> <span class="s1">'time_step'</span><span class="p">,</span> <span class="s1">'u_in'</span><span class="p">,</span> <span class="s1">'u_out'</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">is_train</span><span class="p">:</span>
            <span class="c1"># build a mask for metric and loss function</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'kfold'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">kfolds</span><span class="p">)]</span><span class="o">.</span><span class="n">u_out</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">80</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'kfold'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">kfolds</span><span class="p">)]</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">80</span><span class="p">))</span>
            
            <span class="c1"># calling scaler also converts the dataframe in an numpy array, which results in speed up while training</span>
            <span class="n">feature_values</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'kfold'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">kfolds</span><span class="p">)][</span><span class="n">features</span><span class="p">])</span> 
            
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">feature_values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)))</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">u_out</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">80</span><span class="p">))</span>
            
            <span class="n">feature_values</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">features</span><span class="p">])</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">feature_values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)))</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="n">features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_train</span> <span class="o">=</span> <span class="n">is_train</span>
        
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_train</span><span class="p">:</span>
            <span class="n">targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">targets</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">sample</span><span class="p">,</span> <span class="n">mask</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">targets</span> <span class="c1">#.float()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model">
<a class="anchor" href="#Model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model<a class="anchor-link" href="#Model"> </a>
</h2>
<p>My model combines a multi layered LSTM and a Transformer Encoder. Additionally I build an AutoEncoder by placing a Transformer Decoder on top of the Transformer encoder. The AutoEncoder predictions are used as auxiliary variables.</p>
<p><img src="/ai_curious/images/copied_from_nb/images/logo_vpp_seq.png" alt=""></p>
<p>Some further considerations:</p>
<ul>
<li>I did not use drop out. The reason why it performence worse is discussed <a href="https://www.kaggle.com/c/ventilator-pressure-prediction/discussion/276719">here</a>.</li>
<li>LayerNorm can be used in sequential models but didn't improve my score.</li>
</ul>
<p>The model is influenced by these notebooks:</p>
<ul>
<li><a href="https://pytorch.org/tutorials/beginner/transformer_tutorial.html">Transformer part</a></li>
<li><a href="https://www.kaggle.com/theoviel/deep-learning-starter-simple-lstm">LSTM part</a></li>
<li><a href="https://www.kaggle.com/junkoda/pytorch-lstm-with-tensorflow-like-initialization">Parameter initialization</a></li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Transformer: https://pytorch.org/tutorials/beginner/transformer_tutorial.html</span>
<span class="c1"># LSTM: https://www.kaggle.com/theoviel/deep-learning-starter-simple-lstm</span>
<span class="c1"># Parameter init from: https://www.kaggle.com/junkoda/pytorch-lstm-with-tensorflow-like-initialization </span>

<span class="k">class</span> <span class="nc">VPPEncoder</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fin</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">nhead</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">nhid</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span> <span class="n">nlayers</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">seq_len</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">use_decoder</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VPPEncoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
                 
        <span class="bp">self</span><span class="o">.</span><span class="n">seq_len</span> <span class="o">=</span> <span class="n">seq_len</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_decoder</span> <span class="o">=</span> <span class="n">use_decoder</span>
        
        <span class="c1"># number of input features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fin</span> <span class="o">=</span> <span class="n">fin</span>
                      
        <span class="c1">#self.tail = nn.Sequential(</span>
        <span class="c1">#    nn.Linear(self.fin, nhid),</span>
        <span class="c1">#    #nn.LayerNorm(nhid),</span>
        <span class="c1">#    nn.SELU(),</span>
        <span class="c1">#    nn.Linear(nhid, fin),</span>
        <span class="c1">#    #nn.LayerNorm(nhid),</span>
        <span class="c1">#    nn.SELU(),</span>
        <span class="c1">#    #nn.Dropout(0.05),</span>
        <span class="c1">#)                </span>
            
        <span class="n">encoder_layers</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">TransformerEncoderLayer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fin</span><span class="p">,</span> <span class="n">nhead</span><span class="p">,</span> <span class="n">nhid</span> <span class="p">,</span> <span class="n">activation</span><span class="o">=</span> <span class="s1">'gelu'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformer_encoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">TransformerEncoder</span><span class="p">(</span><span class="n">encoder_layers</span><span class="p">,</span> <span class="n">nlayers</span><span class="p">)</span>
        
        <span class="n">decoder_layers</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">TransformerDecoderLayer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fin</span><span class="p">,</span> <span class="n">nhead</span><span class="p">,</span> <span class="n">nhid</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span> <span class="s1">'gelu'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformer_decoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">TransformerDecoder</span><span class="p">(</span><span class="n">decoder_layers</span><span class="p">,</span> <span class="n">nlayers</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">lstm_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">nhid</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">bidirectional</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        
        <span class="c1"># Head</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">nhid</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="n">fin</span> <span class="p">,</span> <span class="n">seq_len</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">seq_len</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
       
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_reinitialize</span><span class="p">()</span>
        

    <span class="c1"># from https://www.kaggle.com/junkoda/pytorch-lstm-with-tensorflow-like-initialization    </span>
    <span class="k">def</span> <span class="nf">_reinitialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Tensorflow/Keras-like initialization</span>
<span class="sd">        """</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">'lstm'</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">'weight_ih'</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">xavier_uniform_</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s1">'weight_hh'</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">orthogonal_</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s1">'bias_ih'</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="c1"># Set forget-gate bias to 1</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">4</span><span class="p">):(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s1">'bias_hh'</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">'fc'</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">'weight'</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">xavier_uniform_</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">gain</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s1">'bias'</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_encoder</span><span class="p">(</span> <span class="n">out</span><span class="p">)</span>
        <span class="n">out_l</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lstm_layer</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_decoder</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_decoder</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span> 
            <span class="n">out_dec_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">out</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:,:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out_dec_diff</span> <span class="o">=</span> <span class="n">out</span><span class="o">*</span><span class="mi">0</span>
        
        <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">out</span><span class="p">,</span> <span class="n">out_l</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="c1"># Head</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">gelu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear1</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear3</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq_len</span><span class="p">)</span> <span class="p">,</span> <span class="n">x</span><span class="p">[:,:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">out_dec_diff</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq_len</span><span class="p">)</span>  
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Metric-and-Loss-Function">
<a class="anchor" href="#Metric-and-Loss-Function" aria-hidden="true"><span class="octicon octicon-link"></span></a>Metric and Loss Function<a class="anchor-link" href="#Metric-and-Loss-Function"> </a>
</h2>
<h3 id="Masked-MAE-metric">
<a class="anchor" href="#Masked-MAE-metric" aria-hidden="true"><span class="octicon octicon-link"></span></a>Masked MAE metric<a class="anchor-link" href="#Masked-MAE-metric"> </a>
</h3>
<p>The competition metric was Mean Absolute Error (MAE), but only for the time-steps where air flows into the lunge (approx. half of the timesteps).
Hence, I masked the predictions (using the flag introduced in the Dataset) ignoring the unnecessary time-steps. The flags are passed through the model (<code>val[1]</code>) and is an output along with the predictions.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">vppMetric</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">preds</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">preds</span><span class="o">*</span><span class="n">flag</span><span class="o">-</span><span class="n">target</span><span class="o">*</span><span class="n">flag</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
    <span class="n">loss</span><span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">flag</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thee values produced by the AutoGenerater are additionally measured by the <code>vppGenMetric</code>. It uses MAE to evaluate how good the reconstruction of the input features values evolves.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">vppGenMetric</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="n">gen</span> <span class="o">=</span><span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="n">flag</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">gen</span><span class="o">*</span><span class="n">flag</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
    <span class="n">loss</span><span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">flag</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Combined-Loss-function">
<a class="anchor" href="#Combined-Loss-function" aria-hidden="true"><span class="octicon octicon-link"></span></a>Combined Loss function<a class="anchor-link" href="#Combined-Loss-function"> </a>
</h2>
<p>The loss function is a combination of L1-derived-Loss (<code>vppAutoLoss</code>) for the predictions and the AutoEncoder-predictions.</p>
<p>Due to <a href="https://www.kaggle.com/c/ventilator-pressure-prediction/discussion/277690">this discussion</a> I did some experiments with variations of Huber and SmoothL1Loss. The later (<code>vppAutoSmoothL1Loss</code>) performed better.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">vppAutoLoss</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="n">gen</span> <span class="o">=</span><span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="n">flag</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">preds</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">preds</span><span class="o">*</span><span class="n">flag</span><span class="o">-</span><span class="n">target</span><span class="o">*</span><span class="n">flag</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">gen</span><span class="o">*</span><span class="n">flag</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">*</span><span class="mf">0.2</span> <span class="c1">#</span>
    <span class="n">loss</span><span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">flag</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">loss</span>
    

<span class="c1"># Adapting https://pytorch.org/docs/stable/generated/torch.nn.SmoothL1Loss.html#torch.nn.SmoothL1Loss</span>
<span class="k">def</span> <span class="nf">vppAutoSmoothL1Loss</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    
    <span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">fct</span> <span class="o">=</span> <span class="mf">0.5</span>
    
    <span class="n">gen</span> <span class="o">=</span><span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    

    <span class="n">flag</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
    
    <span class="n">preds</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">preds</span><span class="o">*</span><span class="n">flag</span><span class="o">-</span><span class="n">target</span><span class="o">*</span><span class="n">flag</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">gen</span><span class="o">*</span><span class="n">flag</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">*</span><span class="mf">0.2</span>
    
    <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">loss</span> <span class="o">&lt;</span> <span class="n">beta</span><span class="p">,</span> <span class="p">(</span><span class="n">fct</span><span class="o">*</span><span class="p">(</span><span class="n">loss</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">beta</span><span class="p">,</span> <span class="n">loss</span><span class="p">)</span><span class="c1">#-fct*beta)</span>
    
    <span class="c1"># reduction mean**0.5</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">flag</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1">#()**0.5</span>
    
    <span class="k">return</span> <span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Training">
<a class="anchor" href="#Training" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training<a class="anchor-link" href="#Training"> </a>
</h1>
<p>The training was done in mixed precision mode (<code>to_fp16()</code>) to speed up training. As optimizer I used <em>QHAdam</em>.
The best single score I achieved with a 100 epoch <code>fit_one_cycle</code> (<em>CosineAnnealing</em> with warmup). I also tried more epochs with restart schedules <code>fit_sgdr</code> and changing loss functions. But the didn't do better.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
                <span class="n">VPPEncoder</span><span class="p">(</span><span class="n">fin</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">),</span> <span class="n">nhead</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">nhid</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="n">nlayers</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">seq_len</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">use_decoder</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span>
                <span class="n">opt_func</span><span class="o">=</span> <span class="n">QHAdam</span><span class="p">,</span>
                <span class="n">loss_func</span> <span class="o">=</span> <span class="n">vppAutoLoss</span><span class="p">,</span> <span class="c1">#vppAutoSmoothL1Loss </span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">vppMetric</span><span class="p">,</span> <span class="n">vppGenMetric</span><span class="p">],</span> 
                <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">ShowGraphCallback</span><span class="p">()])</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span> 

<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="n">EPOCHS</span><span class="p">,</span> <span class="mf">2e-3</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>vppMetric</th>
      <th>vppGenMetric</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.204789</td>
      <td>3.071832</td>
      <td>2.759562</td>
      <td>1.561353</td>
      <td>02:33</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.472645</td>
      <td>1.427370</td>
      <td>1.147190</td>
      <td>1.400903</td>
      <td>02:34</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.130861</td>
      <td>1.373204</td>
      <td>1.108116</td>
      <td>1.325440</td>
      <td>02:32</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.864211</td>
      <td>0.880435</td>
      <td>0.627816</td>
      <td>1.263098</td>
      <td>02:32</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.788929</td>
      <td>0.765516</td>
      <td>0.516083</td>
      <td>1.247169</td>
      <td>02:37</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Th CV score after 100 epochs is 0.227013 for vppMetric and 0.255794 for vppGenMetric. Leaderboard scores for this singele model training in the entire train-dataset were 0.2090 private LB and 0.2091 public LB.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="References">
<a class="anchor" href="#References" aria-hidden="true"><span class="octicon octicon-link"></span></a>References<a class="anchor-link" href="#References"> </a>
</h1>
<ul>
<li>Competition Home Page: <a href="https://www.kaggle.com/c/ventilator-pressure-prediction">https://www.kaggle.com/c/ventilator-pressure-prediction</a>
</li>
<li>Area features: <a href="https://www.kaggle.com/cdeotte/ensemble-folds-with-median-0-153">https://www.kaggle.com/cdeotte/ensemble-folds-with-median-0-153</a>
</li>
<li>Memory reduction: <a href="https://www.kaggle.com/konradb/tabnet-end-to-end-starter">https://www.kaggle.com/konradb/tabnet-end-to-end-starter</a>
</li>
<li>Dataloader from numpy: <a href="https://www.kaggle.com/junkoda/pytorch-lstm-with-tensorflow-like-initialization">https://www.kaggle.com/junkoda/pytorch-lstm-with-tensorflow-like-initialization</a>
</li>
<li>Dropout discussion: <a href="https://www.kaggle.com/c/ventilator-pressure-prediction/discussion/276719">https://www.kaggle.com/c/ventilator-pressure-prediction/discussion/276719</a>
</li>
<li>Transformer model: <a href="https://pytorch.org/tutorials/beginner/transformer_tutorial.html">https://pytorch.org/tutorials/beginner/transformer_tutorial.html</a>
</li>
<li>LSTM model: <a href="https://www.kaggle.com/theoviel/deep-learning-starter-simple-lstm">https://www.kaggle.com/theoviel/deep-learning-starter-simple-lstm</a>
</li>
<li>LSTM parameter initialization: <a href="https://www.kaggle.com/junkoda/pytorch-lstm-with-tensorflow-like-initialization">https://www.kaggle.com/junkoda/pytorch-lstm-with-tensorflow-like-initialization</a>
</li>
<li>SmoothL1Loss discussion: <a href="https://www.kaggle.com/c/ventilator-pressure-prediction/discussion/277690">https://www.kaggle.com/c/ventilator-pressure-prediction/discussion/277690</a>
</li>
</ul>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="joatom/ai_curious"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/ai_curious/timeseries/transformer/lstm/2021/11/22/vpp-seq.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/ai_curious/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/ai_curious/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/ai_curious/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Personal blog</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/joatom" title="joatom"><svg class="svg-icon grey"><use xlink:href="/ai_curious/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/johannestomason" title="johannestomason"><svg class="svg-icon grey"><use xlink:href="/ai_curious/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
